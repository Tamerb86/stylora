# ุฏููู ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุงุณุชุนุงุฏุฉ ูู ุงูููุงุฑุซ
# Backup and Disaster Recovery Guide

## ๐ด ุญุฑุฌ - ูุฌุจ ุงููุฑุงุกุฉ ูุจู ุงูุฅุทูุงู

ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุฅุนุฏุงุฏ ูุธุงู ูุณุฎ ุงุญุชูุงุทู ุขูู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุงููููุงุช ุงูุญุฑุฌุฉ.

---

## ๐ ููุฎุต ุณุฑูุน

**ูุง ูุฌุจ ูุณุฎู ุงุญุชูุงุทููุง:**
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช (MySQL/Supabase) - **ูููููุง**
- โ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ (.env) - **ุนูุฏ ูู ุชุบููุฑ**
- โ ุงููููุงุช ุงููุฑููุนุฉ (ุฅู ูุฌุฏุช) - **ูููููุง**
- โ ุงูุณุฌูุงุช (logs/) - **ุฃุณุจูุนููุง**

**ุงูุชุฑุฏุฏ ุงูููุตู ุจู:**
- ูุณุฎ ุงุญุชูุงุทู ูููู ุชููุงุฆู
- ุงูุงุญุชูุงุธ ุจู 30 ููููุง ุนูู ุงูุฃูู
- ุงุฎุชุจุงุฑ ุงูุงุณุชุนุงุฏุฉ ุดูุฑููุง

---

## 1๏ธโฃ ุงููุณุฎ ุงูุงุญุชูุงุทู ููุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุทุฑููุฉ ุงูุฃููู: Supabase Dashboard (ููุตู ุจูุง)

ุฅุฐุง ููุช ุชุณุชุฎุฏู Supabase:

1. ุงูุชุญ [Supabase Dashboard](https://app.supabase.com)
2. ุงุฎุชุฑ ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู **Settings** โ **Database**
4. ูุณู **Backups**:
   - ุชูุนูู **Point-in-time Recovery (PITR)** ูููุณุฎ ุงููุณุชูุฑ
   - ุชูุนูู **Daily Backups** ูููุณุฎ ุงูููููุฉ
5. ูุชุญููู ูุณุฎุฉ ูุฏููุฉ:
   ```bash
   # ูู ููุญุฉ ุงูุชุญูู: Database โ Backups โ Download
   ```

### ุงูุทุฑููุฉ ุงูุซุงููุฉ: mysqldump (ููุฎูุงุฏู ุงูุฎุงุตุฉ)

```bash
#!/bin/bash
# backup-database.sh

# ุฅุนุฏุงุฏุงุช
DB_HOST="your-database-host"
DB_NAME="barbertime"
DB_USER="your-username"
DB_PASS="your-password"
BACKUP_DIR="/path/to/backups"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/stylora_$DATE.sql.gz"

# ุฅูุดุงุก ูุฌูุฏ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
mkdir -p $BACKUP_DIR

# ุงููุณุฎ ุงูุงุญุชูุงุทู
mysqldump -h $DB_HOST -u $DB_USER -p$DB_PASS $DB_NAME | gzip > $BACKUP_FILE

# ุงูุชุญูู ูู ุงููุฌุงุญ
if [ $? -eq 0 ]; then
    echo "โ Backup successful: $BACKUP_FILE"
    
    # ุญุฐู ุงููุณุฎ ุงูุฃูุฏู ูู 30 ููู
    find $BACKUP_DIR -name "barbertime_*.sql.gz" -mtime +30 -delete
else
    echo "โ Backup failed!"
    exit 1
fi
```

**ุฌุฏููุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููููู:**

```bash
# ุชุนุฏูู crontab
crontab -e

# ุฅุถุงูุฉ ุณุทุฑ ูููุณุฎ ุงูุงุญุชูุงุทู ุงููููู ูู ุงูุณุงุนุฉ 3 ุตุจุงุญูุง
0 3 * * * /path/to/backup-database.sh >> /var/log/backup.log 2>&1
```

---

## 2๏ธโฃ ุงููุณุฎ ุงูุงุญุชูุงุทู ูููุชุบูุฑุงุช ุงูุจูุฆูุฉ

**โ๏ธ ุชุญุฐูุฑ:** ููู `.env` ูุญุชูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ ุฌุฏูุง!

### ุงูุทุฑููุฉ ุงูุขููุฉ:

```bash
# ูุณุฎ .env ุฅูู ููุงู ุขูู ููุดูุฑ
cp .env .env.backup

# ุชุดููุฑ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
gpg --symmetric --cipher-algo AES256 .env.backup

# ุญุฐู ุงููุณุฎุฉ ุบูุฑ ุงููุดูุฑุฉ
rm .env.backup

# ุงูุขู ูุฏูู .env.backup.gpg ูุดูุฑ
# ุงุญูุธู ูู ููุงู ุขูู (ุฎุงุฑุฌ ุงูุณูุฑูุฑ!)
```

### ุงูุงุณุชุนุงุฏุฉ:

```bash
# ูู ุงูุชุดููุฑ
gpg --decrypt .env.backup.gpg > .env

# ุงูุชุญูู ูู ุงููุญุชูู
cat .env
```

**ุฃูุงูู ุขููุฉ ูุญูุธ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:**
- โ ูุฏูุฑ ูููุงุช ุงูุณุฑ (1Password, Bitwarden)
- โ ุฎุฏูุฉ ุชุฎุฒูู ูุดูุฑุฉ (Dropbox ูุน ุชุดููุฑ)
- โ ูุจู ุขูู (Safe deposit box) ูููุณุฎ ุงูุญุฑุฌุฉ
- โ **ูุง ุชุญูุธูุง ูู:**
  - Git repository
  - ุจุฑูุฏ ุฅููุชุฑููู
  - ููุงุญุธุงุช ุบูุฑ ูุดูุฑุฉ

---

## 3๏ธโฃ ุงููุณุฎ ุงูุงุญุชูุงุทู ูููููุงุช ุงููุฑููุนุฉ

ุฅุฐุง ูุงู ุงููุดุฑูุน ูุฎุฒู ูููุงุช ูุฑููุนุฉ (ุตูุฑุ ูุณุชูุฏุงุช):

```bash
#!/bin/bash
# backup-uploads.sh

UPLOADS_DIR="/path/to/uploads"
BACKUP_DIR="/path/to/backups/uploads"
DATE=$(date +%Y%m%d)

# ูุณุฎ ุงููููุงุช
rsync -av --delete $UPLOADS_DIR/ $BACKUP_DIR/$DATE/

# ุถุบุท ุงููุณุฎุฉ
tar -czf $BACKUP_DIR/uploads_$DATE.tar.gz -C $BACKUP_DIR $DATE

# ุญุฐู ุงููุฌูุฏ ุบูุฑ ุงููุถุบูุท
rm -rf $BACKUP_DIR/$DATE

echo "โ Uploads backed up: uploads_$DATE.tar.gz"
```

---

## 4๏ธโฃ ุงููุณุฎ ุงูุงุญุชูุงุทู ููุณุฌูุงุช

```bash
#!/bin/bash
# backup-logs.sh

LOGS_DIR="/path/to/logs"
BACKUP_DIR="/path/to/backups/logs"
DATE=$(date +%Y%m%d)

# ุถุบุท ุงูุณุฌูุงุช
tar -czf $BACKUP_DIR/logs_$DATE.tar.gz -C $LOGS_DIR .

# ุญุฐู ุงูุณุฌูุงุช ุงูุฃูุฏู ูู 90 ููู
find $BACKUP_DIR -name "logs_*.tar.gz" -mtime +90 -delete

echo "โ Logs backed up: logs_$DATE.tar.gz"
```

---

## 5๏ธโฃ ุงุณุชุนุงุฏุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูู Supabase:

1. ุงุฐูุจ ุฅูู **Database** โ **Backups**
2. ุงุฎุชุฑ ุงููุณุฎุฉ ุงููุทููุจุฉ
3. ุงุถุบุท **Restore**
4. ุชุฃููุฏ ุงูุงุณุชุนุงุฏุฉ

### ูู ููู mysqldump:

```bash
# ูู ุงูุถุบุท ูุงูุงุณุชุนุงุฏุฉ
gunzip < barbertime_20240101_030000.sql.gz | mysql -h $DB_HOST -u $DB_USER -p$DB_PASS $DB_NAME

# ุฃู ุจุฎุทูุชูู
gunzip barbertime_20240101_030000.sql.gz
mysql -h $DB_HOST -u $DB_USER -p$DB_PASS $DB_NAME < barbertime_20240101_030000.sql
```

**โ๏ธ ุชุญุฐูุฑ:** ุงูุงุณุชุนุงุฏุฉ ุชุณุชุจุฏู ุฌููุน ุงูุจูุงูุงุช ุงูุญุงููุฉ!

---

## 6๏ธโฃ ุงุฎุชุจุงุฑ ุงููุณุฎ ุงูุงุญุชูุงุทู

**ูุฌุจ ุงุฎุชุจุงุฑ ุงูุงุณุชุนุงุฏุฉ ุดูุฑููุง!**

### ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:

1. **ุฅูุดุงุก ุจูุฆุฉ ุงุฎุชุจุงุฑ:**
   ```bash
   # ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุงุฎุชุจุงุฑ
   mysql -u root -p -e "CREATE DATABASE barbertime_test;"
   ```

2. **ุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ:**
   ```bash
   gunzip < latest_backup.sql.gz | mysql -u root -p barbertime_test
   ```

3. **ุงูุชุญูู ูู ุงูุจูุงูุงุช:**
   ```bash
   mysql -u root -p barbertime_test -e "SELECT COUNT(*) FROM customers;"
   mysql -u root -p barbertime_test -e "SELECT COUNT(*) FROM appointments;"
   ```

4. **ุญุฐู ูุงุนุฏุฉ ุงูุงุฎุชุจุงุฑ:**
   ```bash
   mysql -u root -p -e "DROP DATABASE barbertime_test;"
   ```

---

## 7๏ธโฃ ุณููุงุฑูููุงุช ุงูููุงุฑุซ ูุญููููุง

### ุงูุณููุงุฑูู 1: ููุฏุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ

**ุงูุญู:**
1. ุงุณุชุนุงุฏุฉ ุขุฎุฑ ูุณุฎุฉ ุงุญุชูุงุทูุฉ
2. ุชุทุจูู transaction logs (ุฅู ูุฌุฏุช)
3. ุงูุชุญูู ูู ุณูุงูุฉ ุงูุจูุงูุงุช
4. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู

**ุงูููุช ุงููุชููุน:** 15-30 ุฏูููุฉ

---

### ุงูุณููุงุฑูู 2: ุญุฐู ุจูุงูุงุช ูุณุชุฃุฌุฑ ุจุงูุฎุทุฃ

**ุงูุญู:**
1. ุฅููุงู ุงูุชุทุจูู ููุฑูุง
2. ุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ูุคูุชุฉ
3. ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงููุณุชุฃุฌุฑ ุงููุญุฐูู
4. ุฅุฏุฑุงุฌ ุงูุจูุงูุงุช ูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
5. ุงูุชุญูู ูู ุงูุจูุงูุงุช
6. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู

**SQL ููุงุณุชุฎุฑุงุฌ:**
```sql
-- ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ูุณุชุฃุฌุฑ ูุญุฏุฏ
SELECT * FROM customers WHERE tenantId = 'tenant-id' INTO OUTFILE '/tmp/customers.csv';
SELECT * FROM appointments WHERE tenantId = 'tenant-id' INTO OUTFILE '/tmp/appointments.csv';
-- ... ุฅูุฎ
```

---

### ุงูุณููุงุฑูู 3: ุงุฎุชุฑุงู ุฃููู

**ุงูุญู:**
1. **ุฅููุงู ุงูุชุทุจูู ููุฑูุง**
2. ุชุบููุฑ ุฌููุน ูููุงุช ุงูุณุฑ ูุงูููุงุชูุญ
3. ูุญุต ุงูุณุฌูุงุช ูุชุญุฏูุฏ ูุทุงู ุงูุงุฎุชุฑุงู
4. ุงุณุชุนุงุฏุฉ ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุงุฎุชุฑุงู
5. ุชุตุญูุญ ุงูุซุบุฑุฉ ุงูุฃูููุฉ
6. ุฅุจูุงุบ ุงููุณุชุฎุฏููู ุงููุชุฃุซุฑูู
7. ูุฑุงุฌุนุฉ ุฃูููุฉ ุดุงููุฉ

---

## 8๏ธโฃ ูุงุฆูุฉ ุงูุชุญูู ูุจู ุงูุฅุทูุงู

- [ ] ุชูุนูู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููููู ุงูุชููุงุฆู
- [ ] ุงุฎุชุจุงุฑ ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุจูุฌุงุญ
- [ ] ุญูุธ ูุณุฎุฉ ูู .env ูู ููุงู ุขูู ููุดูุฑ
- [ ] ุฅุนุฏุงุฏ ุชูุจููุงุช ููุดู ุงููุณุฎ ุงูุงุญุชูุงุทู
- [ ] ุชูุซูู ุฅุฌุฑุงุกุงุช ุงูุงุณุชุนุงุฏุฉ ูููุฑูู
- [ ] ุชุญุฏูุฏ ุดุฎุต ูุณุคูู ุนู ุงููุณุฎ ุงูุงุญุชูุงุทู
- [ ] ุฌุฏููุฉ ุงุฎุชุจุงุฑุงุช ุงุณุชุนุงุฏุฉ ุดูุฑูุฉ
- [ ] ุงูุชุฃูุฏ ูู ุชุฎุฒูู ุงููุณุฎ ูู ูููุน ูููุตู ุนู ุงูุณูุฑูุฑ

---

## 9๏ธโฃ ุฃุฏูุงุช ููุตู ุจูุง

### ุฎุฏูุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููุฏุงุฑุฉ:

1. **Supabase Backups** (ูุฏูุฌ)
   - ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู
   - Point-in-time recovery
   - ุณูู ุงูุงุณุชุฎุฏุงู

2. **AWS RDS Automated Backups**
   - ูุณุฎ ุงุญุชูุงุทู ูููู
   - ุงูุงุญุชูุงุธ ุญุชู 35 ููู
   - ุงุณุชุนุงุฏุฉ ุณุฑูุนุฉ

3. **DigitalOcean Managed Databases**
   - ูุณุฎ ุงุญุชูุงุทู ูููู
   - ุงุณุชุนุงุฏุฉ ุจุถุบุทุฉ ุฒุฑ
   - ุชูููุฉ ูุนูููุฉ

### ุฃุฏูุงุช ูุฑุงูุจุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู:

- **Healthchecks.io** - ุชูุจููุงุช ุนูุฏ ูุดู ุงููุณุฎ ุงูุงุญุชูุงุทู
- **Cronitor** - ูุฑุงูุจุฉ cron jobs
- **UptimeRobot** - ูุฑุงูุจุฉ ุชููุฑ ุงูุชุทุจูู

---

## ๐ ุฌูุงุช ุงูุงุชุตุงู ูู ุญุงูุงุช ุงูุทูุงุฑุฆ

**ูุณุคูู ุงููุธุงู:**
- ุงูุงุณู: _______________
- ุงููุงุชู: _______________
- ุงูุจุฑูุฏ: _______________

**ูุณุคูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- ุงูุงุณู: _______________
- ุงููุงุชู: _______________
- ุงูุจุฑูุฏ: _______________

**ุงูุฏุนู ุงูููู (Supabase/AWS):**
- ุงูุฑุงุจุท: _______________
- ุฑูู ุงูุญุณุงุจ: _______________

---

## ๐ ููุงุฑุฏ ุฅุถุงููุฉ

- [Supabase Backup Documentation](https://supabase.com/docs/guides/platform/backups)
- [MySQL Backup Best Practices](https://dev.mysql.com/doc/refman/8.0/en/backup-and-recovery.html)
- [3-2-1 Backup Rule](https://www.backblaze.com/blog/the-3-2-1-backup-strategy/)

---

**ุขุฎุฑ ุชุญุฏูุซ:** ุฏูุณูุจุฑ 2024  
**ุงููุฑุงุฌุนุฉ ุงูุชุงููุฉ:** ููุงูุฑ 2025
